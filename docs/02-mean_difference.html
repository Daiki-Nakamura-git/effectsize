<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>chapter: 3 平均値差の効果量 | 効果量に関するまとめ</title>
  <meta name="description" content="効果量の定義、種類、Rによる計算法、解釈、統合の方法." />
  <meta name="generator" content="bookdown 0.27 and GitBook 2.6.7" />

  <meta property="og:title" content="chapter: 3 平均値差の効果量 | 効果量に関するまとめ" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="効果量の定義、種類、Rによる計算法、解釈、統合の方法." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="chapter: 3 平均値差の効果量 | 効果量に関するまとめ" />
  
  <meta name="twitter:description" content="効果量の定義、種類、Rによる計算法、解釈、統合の方法." />
  

<meta name="author" content="Daiki Nakamura" />


<meta name="date" content="2022-07-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="01-mean.html"/>
<link rel="next" href="03-correlation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">効果量に関するまとめ</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> イントロダクション</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#ドキュメントの概要"><i class="fa fa-check"></i><b>1.1</b> ドキュメントの概要</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#効果量とは何か"><i class="fa fa-check"></i><b>1.2</b> 効果量とは何か</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#効果量を利用するメリット"><i class="fa fa-check"></i><b>1.3</b> 効果量を利用するメリット</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#効果量の種類"><i class="fa fa-check"></i><b>1.4</b> 効果量の種類</a></li>
<li class="chapter" data-level="1.5" data-path="index.html"><a href="index.html#統計ソフトウェアrの準備"><i class="fa fa-check"></i><b>1.5</b> 統計ソフトウェアRの準備</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="01-mean.html"><a href="01-mean.html"><i class="fa fa-check"></i><b>2</b> 平均値と推測統計の基礎</a>
<ul>
<li class="chapter" data-level="2.1" data-path="01-mean.html"><a href="01-mean.html#効果量としての平均値"><i class="fa fa-check"></i><b>2.1</b> 効果量としての平均値</a></li>
<li class="chapter" data-level="2.2" data-path="01-mean.html"><a href="01-mean.html#母平均の推定"><i class="fa fa-check"></i><b>2.2</b> 母平均の推定</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="01-mean.html"><a href="01-mean.html#点推定"><i class="fa fa-check"></i><b>2.2.1</b> 点推定</a></li>
<li class="chapter" data-level="2.2.2" data-path="01-mean.html"><a href="01-mean.html#区間推定"><i class="fa fa-check"></i><b>2.2.2</b> 区間推定</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="01-mean.html"><a href="01-mean.html#ベイズ統計に基づくアプローチ"><i class="fa fa-check"></i><b>2.3</b> ベイズ統計に基づくアプローチ</a></li>
<li class="chapter" data-level="2.4" data-path="01-mean.html"><a href="01-mean.html#結果の報告"><i class="fa fa-check"></i><b>2.4</b> 結果の報告</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="02-mean_difference.html"><a href="02-mean_difference.html"><i class="fa fa-check"></i><b>3</b> 平均値差の効果量</a>
<ul>
<li class="chapter" data-level="3.1" data-path="02-mean_difference.html"><a href="02-mean_difference.html#独立した2群の平均値差"><i class="fa fa-check"></i><b>3.1</b> 独立した2群の平均値差</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="02-mean_difference.html"><a href="02-mean_difference.html#非標準化平均値差"><i class="fa fa-check"></i><b>3.1.1</b> 非標準化平均値差</a></li>
<li class="chapter" data-level="3.1.2" data-path="02-mean_difference.html"><a href="02-mean_difference.html#標準化平均値差"><i class="fa fa-check"></i><b>3.1.2</b> 標準化平均値差</a></li>
<li class="chapter" data-level="3.1.3" data-path="02-mean_difference.html"><a href="02-mean_difference.html#等分散を仮定する場合"><i class="fa fa-check"></i><b>3.1.3</b> 等分散を仮定する場合</a></li>
<li class="chapter" data-level="3.1.4" data-path="02-mean_difference.html"><a href="02-mean_difference.html#等分散を仮定しない場合"><i class="fa fa-check"></i><b>3.1.4</b> 等分散を仮定しない場合</a></li>
<li class="chapter" data-level="3.1.5" data-path="02-mean_difference.html"><a href="02-mean_difference.html#信頼区間"><i class="fa fa-check"></i><b>3.1.5</b> 信頼区間</a></li>
<li class="chapter" data-level="3.1.6" data-path="02-mean_difference.html"><a href="02-mean_difference.html#ベイズ統計に基づくアプローチ-1"><i class="fa fa-check"></i><b>3.1.6</b> ベイズ統計に基づくアプローチ</a></li>
<li class="chapter" data-level="3.1.7" data-path="02-mean_difference.html"><a href="02-mean_difference.html#結果の報告-1"><i class="fa fa-check"></i><b>3.1.7</b> 結果の報告</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="02-mean_difference.html"><a href="02-mean_difference.html#対応のある2群の平均値差"><i class="fa fa-check"></i><b>3.2</b> 対応のある2群の平均値差</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="02-mean_difference.html"><a href="02-mean_difference.html#非標準化平均値差-1"><i class="fa fa-check"></i><b>3.2.1</b> 非標準化平均値差</a></li>
<li class="chapter" data-level="3.2.2" data-path="02-mean_difference.html"><a href="02-mean_difference.html#標準化平均値差-1"><i class="fa fa-check"></i><b>3.2.2</b> 標準化平均値差</a></li>
<li class="chapter" data-level="3.2.3" data-path="02-mean_difference.html"><a href="02-mean_difference.html#信頼区間-1"><i class="fa fa-check"></i><b>3.2.3</b> 信頼区間</a></li>
<li class="chapter" data-level="3.2.4" data-path="02-mean_difference.html"><a href="02-mean_difference.html#結果の報告-2"><i class="fa fa-check"></i><b>3.2.4</b> 結果の報告</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="02-mean_difference.html"><a href="02-mean_difference.html#標準化平均値差の補正"><i class="fa fa-check"></i><b>3.3</b> 標準化平均値差の補正</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="02-mean_difference.html"><a href="02-mean_difference.html#小標本の補正"><i class="fa fa-check"></i><b>3.3.1</b> 小標本の補正</a></li>
<li class="chapter" data-level="3.3.2" data-path="02-mean_difference.html"><a href="02-mean_difference.html#信頼性の補正"><i class="fa fa-check"></i><b>3.3.2</b> 信頼性の補正</a></li>
<li class="chapter" data-level="3.3.3" data-path="02-mean_difference.html"><a href="02-mean_difference.html#範囲制限の補正"><i class="fa fa-check"></i><b>3.3.3</b> 範囲制限の補正</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="02-mean_difference.html"><a href="02-mean_difference.html#名称の混乱問題について"><i class="fa fa-check"></i><b>3.4</b> 名称の混乱問題について</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="03-correlation.html"><a href="03-correlation.html"><i class="fa fa-check"></i><b>4</b> 相関の効果量</a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="03-correlation.html"><a href="03-correlation.html#pearsons-r"><i class="fa fa-check"></i><b>4.0.1</b> Pearson’s r</a></li>
<li class="chapter" data-level="4.0.2" data-path="03-correlation.html"><a href="03-correlation.html#ベイズ"><i class="fa fa-check"></i><b>4.0.2</b> ベイズ</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="04-ANOVA.html"><a href="04-ANOVA.html"><i class="fa fa-check"></i><b>5</b> 分散の効果量</a>
<ul>
<li class="chapter" data-level="5.1" data-path="04-ANOVA.html"><a href="04-ANOVA.html#一元配置分散分析"><i class="fa fa-check"></i><b>5.1</b> 一元配置分散分析</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="04-ANOVA.html"><a href="04-ANOVA.html#効果量"><i class="fa fa-check"></i><b>5.1.1</b> 効果量</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="04-ANOVA.html"><a href="04-ANOVA.html#二元配置分散分析"><i class="fa fa-check"></i><b>5.2</b> 二元配置分散分析</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="04-ANOVA.html"><a href="04-ANOVA.html#ベイズ-1"><i class="fa fa-check"></i><b>5.2.1</b> ベイズ</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="05-ratio.html"><a href="05-ratio.html"><i class="fa fa-check"></i><b>6</b> 比率の効果量</a></li>
<li class="chapter" data-level="7" data-path="06-single_case.html"><a href="06-single_case.html"><i class="fa fa-check"></i><b>7</b> 単一事例研究の効果量</a></li>
<li class="chapter" data-level="8" data-path="07-conversion.html"><a href="07-conversion.html"><i class="fa fa-check"></i><b>8</b> 効果量の変換</a>
<ul>
<li class="chapter" data-level="8.1" data-path="07-conversion.html"><a href="07-conversion.html#統計量から効果量への変換"><i class="fa fa-check"></i><b>8.1</b> 統計量から効果量への変換</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="07-conversion.html"><a href="07-conversion.html#t---d"><i class="fa fa-check"></i><b>8.1.1</b> t -&gt; d</a></li>
</ul></li>
<li class="chapter" data-level="8.2" data-path="07-conversion.html"><a href="07-conversion.html#効果量から効果量への変換"><i class="fa fa-check"></i><b>8.2</b> 効果量から効果量への変換</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="07-conversion.html"><a href="07-conversion.html#d---r"><i class="fa fa-check"></i><b>8.2.1</b> d &lt;-&gt; r</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="08-interpret.html"><a href="08-interpret.html"><i class="fa fa-check"></i><b>9</b> 効果量の解釈と利用</a>
<ul>
<li class="chapter" data-level="9.1" data-path="08-interpret.html"><a href="08-interpret.html#共通言語効果量"><i class="fa fa-check"></i><b>9.1</b> 共通言語効果量</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="08-interpret.html"><a href="08-interpret.html#優越率probability-of-superiority"><i class="fa fa-check"></i><b>9.1.1</b> 優越率（Probability of Superiority）</a></li>
<li class="chapter" data-level="9.1.2" data-path="08-interpret.html"><a href="08-interpret.html#cohens-u3"><i class="fa fa-check"></i><b>9.1.2</b> Cohen’s U3</a></li>
<li class="chapter" data-level="9.1.3" data-path="08-interpret.html"><a href="08-interpret.html#被覆度overlap"><i class="fa fa-check"></i><b>9.1.3</b> 被覆度（Overlap）</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="08-interpret.html"><a href="08-interpret.html#cohenの規準"><i class="fa fa-check"></i><b>9.2</b> Cohenの規準</a></li>
<li class="chapter" data-level="9.3" data-path="08-interpret.html"><a href="08-interpret.html#分野ごとに細分化された規準"><i class="fa fa-check"></i><b>9.3</b> 分野ごとに細分化された規準</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="09-meta_analysis.html"><a href="09-meta_analysis.html"><i class="fa fa-check"></i><b>10</b> メタ分析</a></li>
<li class="chapter" data-level="11" data-path="10-pawer_analysis.html"><a href="10-pawer_analysis.html"><i class="fa fa-check"></i><b>11</b> 検定力分析</a></li>
<li class="chapter" data-level="12" data-path="11-discussion.html"><a href="11-discussion.html"><i class="fa fa-check"></i><b>12</b> 引用文献リスト</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">効果量に関するまとめ</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="平均値差の効果量" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">chapter: 3</span> 平均値差の効果量<a href="02-mean_difference.html#平均値差の効果量" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>本章では、２群間の平均値差に関する効果量とその信頼区間の計算方法を紹介する。平均値差に関する標準化効果量には複数の種類が存在するが、研究によってそれらの呼び方や使用する記号が異なることがあるので注意が必要である。</p>
<div id="独立した2群の平均値差" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> 独立した2群の平均値差<a href="02-mean_difference.html#独立した2群の平均値差" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>2つの独立した母集団A, Bから抽出した2標本の平均値差について検討する。いま、2つの正規母集団 <span class="math inline">\(\mathcal{N_A}(60, 100), \mathcal{N_B}(50, 100)\)</span> から無作為抽出によって100個ずつ（<span class="math inline">\(m=100, n=100\)</span>）の独立な標本を得たとする。<span class="math display">\[
A_1, A_2, ..., A_{m} \sim \mathcal{N}(60, 100),\\
B_1, B_2, ..., B_{n} \sim \mathcal{N}(50, 100)
\]</span></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="02-mean_difference.html#cb14-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span> ; n <span class="ot">&lt;-</span> <span class="dv">100</span>   <span class="co"># サンプルサイズ</span></span>
<span id="cb14-2"><a href="02-mean_difference.html#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)         <span class="co"># 乱数の種の固定</span></span>
<span id="cb14-3"><a href="02-mean_difference.html#cb14-3" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m, <span class="dv">60</span>, <span class="dv">10</span>) <span class="co"># 正規分布N(50,100)からm個の乱数を発生</span></span>
<span id="cb14-4"><a href="02-mean_difference.html#cb14-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>) <span class="co"># 正規分布N(60,100)からn個の乱数を発生</span></span></code></pre></div>
<p><img src="effectsize_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>独立した2群の平均値差を示す効果量には、非標準化平均値差と標準化平均値差の2種類がある。また、後者については、等分散が仮定できる場合とできない場合に分けて考えることができる。以下で順に紹介していく。</p>
<div id="非標準化平均値差" class="section level3 hasAnchor" number="3.1.1">
<h3><span class="header-section-number">3.1.1</span> 非標準化平均値差<a href="02-mean_difference.html#非標準化平均値差" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>2群の平均値差Dは、以下の式で求められる。これは、平均値と同様に非標準化効果量の一種であり、元の測定単位における比較に関心がある場合などに有用である。</p>
<p><span class="math display">\[
平均値差D=\bar{A}-\bar{B}
\]</span> 平均値差Dは、母平均値差 <span class="math inline">\(\mu_A-\mu_B\)</span> の一致推定量かつ不偏推定量であり、平均<span class="math inline">\(\mu_A-\mu_B\)</span>、分散 <span class="math inline">\(\sigma_A^2/m+\sigma_B^2/n\)</span> の正規分布に従う。母分散が既知の場合は、以下のように95%信頼区間を構成すればよい。</p>
<p><span class="math display">\[
D-1.96\sqrt{\frac{\sigma_A^2}{m}+\frac{\sigma_B^2}{n}}\leq\mu_A-\mu_B\leq D+1.96\sqrt{\frac{\sigma_A^2}{m}+\frac{\sigma_B^2}{n}}
\]</span> Rを利用すれば、以下のように計算できる。</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="02-mean_difference.html#cb15-1" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">mean</span>(A) <span class="sc">-</span> <span class="fu">mean</span>(B)     <span class="co"># 非標準化平均値差</span></span>
<span id="cb15-2"><a href="02-mean_difference.html#cb15-2" aria-hidden="true" tabindex="-1"></a>D <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">100</span><span class="sc">/</span>m<span class="sc">+</span><span class="dv">100</span><span class="sc">/</span>n) <span class="co"># 95%信頼区間の下限値</span></span></code></pre></div>
<pre><code>## [1] 9.207668</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="02-mean_difference.html#cb17-1" aria-hidden="true" tabindex="-1"></a>D <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span><span class="fu">sqrt</span>(<span class="dv">100</span><span class="sc">/</span>m<span class="sc">+</span><span class="dv">100</span><span class="sc">/</span>n) <span class="co"># 95%信頼区間の上限値</span></span></code></pre></div>
<pre><code>## [1] 14.75139</code></pre>
<p>母分散が未知であるが集団間で等しいことが分かっている場合、2群に共通した分散を以下の通り求めて、母分散の推定値として利用する。ここで、<span class="math inline">\(\hat\sigma_A^2\)</span> は群Aの不偏分散、<span class="math inline">\(\hat\sigma_B^2\)</span> は群Bの不偏分差を指す。 <span class="math display">\[
\hat\sigma^2=\frac{(m-1)\hat\sigma_A^2+(n-1)\hat\sigma_B^2}{m+n-2}
\]</span> 平均値差の標本分布として、正規分布ではなく自由度 <span class="math inline">\(m+n-2\)</span> のｔ分布を利用して、以下の通り95%信頼区間を求める。 <span class="math display">\[
D-t_{0.025}(m+n-2)\sqrt{\frac{\hat\sigma^2}{m}+\frac{\hat\sigma^2}{n}}\leq\mu_A-\mu_B\leq D+t_{0.975}(m+n-2)\sqrt{\frac{\hat\sigma^2}{m}+\frac{\hat\sigma^2}{n}}
\]</span> Rを利用すれば、以下のように計算できる。</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="02-mean_difference.html#cb19-1" aria-hidden="true" tabindex="-1"></a>pooled_var <span class="ot">&lt;-</span> ((m<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(A)<span class="sc">+</span>(n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(B))<span class="sc">/</span>(m<span class="sc">+</span>n<span class="dv">-2</span>)  <span class="co"># 2群に共通した分散の推定値</span></span>
<span id="cb19-2"><a href="02-mean_difference.html#cb19-2" aria-hidden="true" tabindex="-1"></a>D <span class="sc">-</span> <span class="fu">qt</span>(<span class="fl">0.025</span>, m<span class="sc">+</span>n<span class="dv">-2</span>, <span class="at">lower.tail =</span> F)<span class="sc">*</span><span class="fu">sqrt</span>(pooled_var<span class="sc">/</span>m <span class="sc">+</span> pooled_var<span class="sc">/</span>n)  <span class="co"># 95%信頼区間の下限値</span></span></code></pre></div>
<pre><code>## [1] 9.357192</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="02-mean_difference.html#cb21-1" aria-hidden="true" tabindex="-1"></a>D <span class="sc">+</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, m<span class="sc">+</span>n<span class="dv">-2</span>)<span class="sc">*</span><span class="fu">sqrt</span>(pooled_var<span class="sc">/</span>m <span class="sc">+</span> pooled_var<span class="sc">/</span>n)                  <span class="co"># 95%信頼区間の上限値</span></span></code></pre></div>
<pre><code>## [1] 14.60186</code></pre>
<p>既存の関数を利用して95%信頼区間を求めても結果は一致する。</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="02-mean_difference.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(A, B, <span class="at">var.equal =</span> T)<span class="sc">$</span>conf.int</span></code></pre></div>
<pre><code>## [1]  9.357192 14.601862
## attr(,&quot;conf.level&quot;)
## [1] 0.95</code></pre>
</div>
<div id="標準化平均値差" class="section level3 hasAnchor" number="3.1.2">
<h3><span class="header-section-number">3.1.2</span> 標準化平均値差<a href="02-mean_difference.html#標準化平均値差" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>2群の標準化平均値差に関する母効果量<span class="math inline">\(\delta\)</span>は以下の式で定義される。 <span class="math display">\[
\delta=\frac{μ_A-μ_B}{σ}
\]</span>ここで<span class="math inline">\(μ_A\)</span>，<span class="math inline">\(μ_B\)</span>はそれぞれ群A, 群Bの母平均、<span class="math inline">\(σ\)</span>は2群に共通な母標準偏差である。</p>
<p>得られた標本から母効果量<span class="math inline">\(\delta\)</span>を推定する場合、その推定量を標本効果量と呼ぶ。 標準化平均値差の標本効果量にはいくつかの種類が提案されている。等分散を仮定する場合と等分散を仮定しない場合に分けて順に紹介する。</p>
<p>使用するデータは前節と同様である。</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="02-mean_difference.html#cb25-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span> ; n <span class="ot">&lt;-</span> <span class="dv">100</span>   <span class="co"># サンプルサイズ</span></span>
<span id="cb25-2"><a href="02-mean_difference.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)         <span class="co"># 乱数の種の固定</span></span>
<span id="cb25-3"><a href="02-mean_difference.html#cb25-3" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m, <span class="dv">60</span>, <span class="dv">10</span>) <span class="co"># 正規分布N(50,100)からm個の乱数を発生</span></span>
<span id="cb25-4"><a href="02-mean_difference.html#cb25-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>) <span class="co"># 正規分布N(60,100)からn個の乱数を発生</span></span></code></pre></div>
<p>なお、統計的帰無仮説検定によって2群の平均値差を検討する方法としてはｔ検定が知られており、検定統計量ｔがｔ分布に従うことを利用して、群間で平均値に差が無いという帰無仮説を棄却できるかどうかを判断する。</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="02-mean_difference.html#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(A, B, <span class="at">var.equal =</span> T) <span class="co"># 等分散を仮定する場合（Student&#39;s t-test）</span></span></code></pre></div>
<pre><code>## 
##  Two Sample t-test
## 
## data:  A and B
## t = 9.0087, df = 198, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##   9.357192 14.601862
## sample estimates:
## mean of x mean of y 
##  60.90406  48.92453</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="02-mean_difference.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">t.test</span>(A, B, <span class="at">var.equal =</span> F) <span class="co"># 等分散を仮定しない場合（Welch&#39;s t-test）</span></span></code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  A and B
## t = 9.0087, df = 197.35, p-value &lt; 2.2e-16
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##   9.357138 14.601916
## sample estimates:
## mean of x mean of y 
##  60.90406  48.92453</code></pre>
</div>
<div id="等分散を仮定する場合" class="section level3 hasAnchor" number="3.1.3">
<h3><span class="header-section-number">3.1.3</span> 等分散を仮定する場合<a href="02-mean_difference.html#等分散を仮定する場合" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>等分散を仮定する場合の標本効果量は主に2種類ある。 これは、2つの集団の分散をどのような計算式で統合（pool）するかの違いである。分散を統合する計算式には、標本分散を用いるものと不偏分散を用いるものがある。</p>
<p>標本分散を用いて統合する場合、以下の式になる。ここで、<span class="math inline">\(s_A^2\)</span> は群Aの標本分散、<span class="math inline">\(s_B^2\)</span> は群Bの標本分差を指す。</p>
<p><span class="math display">\[
s_A^2=\frac{1}{m}\sum_{i=1}^{m}(A_i-\bar{A}), s_B^2=\frac{1}{n}\sum_{i=1}^{n}(B_i-\bar{B}), \\
s_{pooled}=\sqrt\frac{ms_A^2+ns_B^2}{m+n}
\]</span> Rを利用すれば、以下のように計算できる。</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="02-mean_difference.html#cb30-1" aria-hidden="true" tabindex="-1"></a>Va <span class="ot">&lt;-</span> <span class="fu">var</span>(A)<span class="sc">*</span>(m<span class="dv">-1</span>)<span class="sc">/</span>m  <span class="co"># Aの標本分散</span></span>
<span id="cb30-2"><a href="02-mean_difference.html#cb30-2" aria-hidden="true" tabindex="-1"></a>Vb <span class="ot">&lt;-</span> <span class="fu">var</span>(B)<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n  <span class="co"># Bの標本分散</span></span>
<span id="cb30-3"><a href="02-mean_difference.html#cb30-3" aria-hidden="true" tabindex="-1"></a>s_pooled <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((m<span class="sc">*</span>Va<span class="sc">+</span>n<span class="sc">*</span>Vb)<span class="sc">/</span>(m<span class="sc">+</span>n))</span></code></pre></div>
<p>不偏分散を用いて統合する場合、以下の式になる。ここで、<span class="math inline">\(\hat\sigma_A^2\)</span> は群Aの不偏分散、<span class="math inline">\(\hat\sigma_B^2\)</span> は群Bの不偏分差を指す。</p>
<p><span class="math display">\[
\hat\sigma_A^2=\frac{1}{m-1}\sum_{i=1}^{m}(A_i-\bar{A}), \hat\sigma_B^2=\frac{1}{n-1}\sum_{i=1}^{n}(B_i-\bar{B}) \\
\hat\sigma=\sqrt\frac{(m-1)\hat\sigma_A^2+(n-1)\hat\sigma_B^2}{m+n-2}
\]</span> Rを利用すれば、以下のように計算できる。</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="02-mean_difference.html#cb31-1" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(((m<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(A)<span class="sc">+</span>(n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">var</span>(B))<span class="sc">/</span>(m<span class="sc">+</span>n<span class="dv">-2</span>))</span></code></pre></div>
<p>2種類の推定量の間には、以下のような関係がある。 <span class="math display">\[
\hat\sigma=s_{pooled}\sqrt{\frac{m+n}{m+n-2}}
\]</span></p>
<p>2種類の推定量を用いることでそれぞれ、Hedges &amp; Olkin の <span class="math inline">\(d\)</span> とCohenの <span class="math inline">\(d_s\)</span> という効果量が計算できる。順に紹介していく。</p>
<div id="hedges-olkins-d" class="section level4 hasAnchor" number="3.1.3.1">
<h4><span class="header-section-number">3.1.3.1</span> Hedges &amp; Olkin’s <span class="math inline">\(d\)</span><a href="02-mean_difference.html#hedges-olkins-d" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>1つ目は、Hedges &amp; Olkin の <span class="math inline">\(d\)</span>であり、平均値差を2群に共通した標準偏差（<span class="math inline">\(s_{pooled}\)</span>）で割ることで得られる。これは、母効果量<span class="math inline">\(\delta\)</span>の最尤推定量である<span class="citation">(<a href="#ref-hedges1985" role="doc-biblioref">Hedges &amp; Olkin, 1985</a>)</span>。この式で計算したものを Cohen’s <span class="math inline">\(d\)</span> と表現している文献もあるので、注意が必要である。</p>
<p><span class="math display">\[
d =\frac{\bar{A}-\bar{B}}{s_{pooled}}
\]</span></p>
<p>誤差分散は以下の式で求められる。誤差分散の平方根を求めれば標準誤差になる。</p>
<p><span class="math display">\[
V_d=\frac{m+n}{mn}+\frac{d^2}{2(m+n-2)}
\]</span> Rを利用すれば、Hedges &amp; Olkin の <span class="math inline">\(d\)</span> は以下のように計算できる。</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="02-mean_difference.html#cb32-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mean</span>(A)<span class="sc">-</span><span class="fu">mean</span>(B))<span class="sc">/</span>s_pooled  <span class="co"># Hedges &amp; Olkin&#39;s d</span></span></code></pre></div>
<pre><code>## [1] 1.280441</code></pre>
</div>
<div id="cohens-d_s" class="section level4 hasAnchor" number="3.1.3.2">
<h4><span class="header-section-number">3.1.3.2</span> Cohen’s <span class="math inline">\(d_s\)</span><a href="02-mean_difference.html#cohens-d_s" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>2つ目は、Cohenの <span class="math inline">\(d_s\)</span> であり、平均値差を2群に共通した標準偏差（<span class="math inline">\(\hat\sigma\)</span>）で割ることで得られる<span class="citation">(<a href="#ref-cohen1988" role="doc-biblioref">Cohen, 1988</a>)</span>。この式で計算したものを Cohen’s <span class="math inline">\(d\)</span> や Hedges’ <span class="math inline">\(g\)</span> と表現している文献もあるので、注意が必要である。名称の混乱問題については本章の最後で解説する。</p>
<p><span class="math display">\[
Cohen&#39;s~d_s =\frac{\bar{A}-\bar{B}}{\hat\sigma}
\]</span> 誤差分散は以下の式で求められる。誤差分散の平方根を求めれば標準誤差になる。 <span class="math display">\[
V_{d_s}=\frac{m+n}{mn}+\frac {d_s^2}{2(m+n)}
\]</span> Rを利用すれば、Cohenの <span class="math inline">\(d_s\)</span> は以下のように計算できる。</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="02-mean_difference.html#cb34-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mean</span>(A)<span class="sc">-</span><span class="fu">mean</span>(B))<span class="sc">/</span>sigma  <span class="co"># Cohen&#39;s d_s</span></span></code></pre></div>
<pre><code>## [1] 1.274023</code></pre>
<p>既存のパッケージを利用した場合でも同様の結果が得られる。</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="02-mean_difference.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb36-2"><a href="02-mean_difference.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cohens_d</span>(A, B)  <span class="co"># Cohen&#39;s d_s</span></span></code></pre></div>
<pre><code>## Cohen&#39;s d |       95% CI
## ------------------------
## 1.27      | [0.97, 1.58]
## 
## - Estimated using pooled SD.</code></pre>
</div>
</div>
<div id="等分散を仮定しない場合" class="section level3 hasAnchor" number="3.1.4">
<h3><span class="header-section-number">3.1.4</span> 等分散を仮定しない場合<a href="02-mean_difference.html#等分散を仮定しない場合" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="glasss-delta" class="section level4 hasAnchor" number="3.1.4.1">
<h4><span class="header-section-number">3.1.4.1</span> Glass’s <span class="math inline">\(\Delta\)</span><a href="02-mean_difference.html#glasss-delta" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>等分散を仮定しない場合の標本効果量としては、Glassの <span class="math inline">\(\Delta\)</span> がある。 これは、実験デザインに由来して群間で分散が異なることが想定される場合に有用である。 例えば、実験群にのみ介入を行い、その介入が分散を拡大させると考えられる場合、介入を行っていない統制群の分散の推定値を効果量の計算に用いる方が適切だと考えられる<span class="citation">(<a href="#ref-grissom2001" role="doc-biblioref">Grissom &amp; Kim, 2001</a>)</span>。Glassの <span class="math inline">\(\Delta\)</span> はこのような考え方に基づき、2群のうち片方の群の分散（標準偏差）のみを用いて効果量を計算する。</p>
<p>なお、使用するデータは、分散を変更している。</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="02-mean_difference.html#cb38-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span> ; n <span class="ot">&lt;-</span> <span class="dv">100</span>   <span class="co"># サンプルサイズ</span></span>
<span id="cb38-2"><a href="02-mean_difference.html#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)         <span class="co"># 乱数の種の固定</span></span>
<span id="cb38-3"><a href="02-mean_difference.html#cb38-3" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m, <span class="dv">60</span>, <span class="dv">12</span>) <span class="co"># 正規分布N(50,144)からm個の乱数を発生</span></span>
<span id="cb38-4"><a href="02-mean_difference.html#cb38-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>) <span class="co"># 正規分布N(60,100)からn個の乱数を発生</span></span></code></pre></div>
<p>Glassの <span class="math inline">\(\Delta\)</span> は以下の計算式の通り、平均値差を片方の群（統制群）の標準偏差で割ることで得られる<span class="citation">(<a href="#ref-glass1981" role="doc-biblioref">Glass et al., 1981</a>)</span>。ここで、<span class="math inline">\(\hat\sigma_B^2\)</span> は群Bの不偏分差を指す。ここでは、群Bが統制群であることを想定している。</p>
<p><span class="math display">\[
Glass&#39;s~\Delta =\frac{\bar{A}-\bar{B}}{\hat\sigma_B}
\]</span></p>
<p>誤差分散は以下の式で求められる<span class="citation">(<a href="#ref-kline2004" role="doc-biblioref">Kline, 2004, p. 108</a>)</span>。<span class="math display">\[
V_{\Delta}=\frac{m+n}{mn}+\frac {\Delta^2}{2(n-1)}
\]</span> Rを利用すれば、Glassの <span class="math inline">\(\Delta\)</span> は以下のように計算できる。</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="02-mean_difference.html#cb39-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mean</span>(A)<span class="sc">-</span><span class="fu">mean</span>(B))<span class="sc">/</span><span class="fu">sd</span>(B)  <span class="co"># Glass&#39;s delta</span></span></code></pre></div>
<pre><code>## [1] 1.25755</code></pre>
<p>既存のパッケージを利用した場合でも同様の結果が得られる。</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="02-mean_difference.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb41-2"><a href="02-mean_difference.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glass_delta</span>(A, B)  <span class="co"># Glass&#39;s delta</span></span></code></pre></div>
<pre><code>## Glass&#39; delta |       95% CI
## ---------------------------
## 1.26         | [0.91, 1.60]</code></pre>
</div>
<div id="cohens-d_s-1" class="section level4 hasAnchor" number="3.1.4.2">
<h4><span class="header-section-number">3.1.4.2</span> Cohen’s <span class="math inline">\(d_s\)</span><a href="02-mean_difference.html#cohens-d_s-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>なお、等分散が仮定できるが、分散の推定値に群間で差があった場合は、両群の情報を活用できる <span class="math inline">\(d\)</span> や <span class="math inline">\(d_s\)</span> を使用した方がいいだろう<span class="citation">(<a href="#ref-grissom2001" role="doc-biblioref">Grissom &amp; Kim, 2001</a>)</span>。例えば、分散の推定値に群間で差があった場合のCohenの <span class="math inline">\(d_s\)</span> は以下の通り計算することが推奨されている<span class="citation">(<a href="#ref-delacre2021" role="doc-biblioref">Delacre et al., 2021</a>)</span>。ここで、<span class="math inline">\(\hat\sigma_A^2\)</span> は群Aの不偏分散、<span class="math inline">\(\hat\sigma_B^2\)</span> は群Bの不偏分差を指す。</p>
<p><span class="math display">\[
Cohen&#39;s~d_s=\frac{\bar{A}-\bar{B}}{\sqrt{(\hat\sigma_A^2+\hat\sigma_B^2)/2}}
\]</span></p>
<p>Rを利用すれば、分散が異なる場合のCohenの <span class="math inline">\(d_s\)</span> は以下のように計算できる。</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="02-mean_difference.html#cb43-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mean</span>(A)<span class="sc">-</span><span class="fu">mean</span>(B))<span class="sc">/</span><span class="fu">sqrt</span>((<span class="fu">var</span>(A)<span class="sc">+</span><span class="fu">var</span>(B))<span class="sc">/</span><span class="dv">2</span>)</span></code></pre></div>
<pre><code>## [1] 1.176983</code></pre>
<p>既存のパッケージを利用した場合でも同様の結果が得られる。</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="02-mean_difference.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb45-2"><a href="02-mean_difference.html#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cohens_d</span>(A, B, <span class="at">pooled_sd =</span> F)</span></code></pre></div>
<pre><code>## Cohen&#39;s d |       95% CI
## ------------------------
## 1.18      | [0.87, 1.48]
## 
## - Estimated using un-pooled SD.</code></pre>
</div>
</div>
<div id="信頼区間" class="section level3 hasAnchor" number="3.1.5">
<h3><span class="header-section-number">3.1.5</span> 信頼区間<a href="02-mean_difference.html#信頼区間" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>標準化平均値差の効果量の信頼区間を算出する方法には、1．標準誤差を用いる方法、2．非心ｔ分布に基づく方法、3．ブートストラップ法の3種類がある<span class="citation">(<a href="#ref-inoue2008" role="doc-biblioref">井上俊哉, 2008</a>)</span>。以下で順に紹介する。なお、使用するデータは以下の通りである。</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="02-mean_difference.html#cb47-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span> ; n <span class="ot">&lt;-</span> <span class="dv">100</span>   <span class="co"># サンプルサイズ</span></span>
<span id="cb47-2"><a href="02-mean_difference.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)         <span class="co"># 乱数の種の固定</span></span>
<span id="cb47-3"><a href="02-mean_difference.html#cb47-3" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m, <span class="dv">60</span>, <span class="dv">10</span>) <span class="co"># 正規分布N(60,100)からm個の乱数を発生</span></span>
<span id="cb47-4"><a href="02-mean_difference.html#cb47-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>) <span class="co"># 正規分布N(50,100)からn個の乱数を発生</span></span></code></pre></div>
<div id="標準誤差を用いる方法" class="section level4 hasAnchor" number="3.1.5.1">
<h4><span class="header-section-number">3.1.5.1</span> 標準誤差を用いる方法<a href="02-mean_difference.html#標準誤差を用いる方法" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>1つ目は、標準誤差 <span class="math inline">\(se\)</span>（誤差分散<span class="math inline">\(V_{\hat\delta}\)</span>の平方根）を用いる簡易的な方法である。効果量の標本分布を正規分布で近似することで、95％信頼区間は以下のように計算できる<span class="citation">(<a href="#ref-nakagawa2007" role="doc-biblioref">Nakagawa &amp; Cuthill, 2007</a>)</span>。ここで、<span class="math inline">\(\hat\delta\)</span> は、母効果量 <span class="math inline">\(\delta\)</span> の推定値である標本効果量（<span class="math inline">\(d, d_S, \Delta\)</span>）を指す。</p>
<p><span class="math display">\[
\hat{\delta}-1.96*se\leq\delta\leq\hat{\delta}+1.96*se
\]</span></p>
<p>例えば、Cohen’s <span class="math inline">\(d_s\)</span> の95%信頼区間は以下のように求められる。</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="02-mean_difference.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb48-2"><a href="02-mean_difference.html#cb48-2" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">cohens_d</span>(A, B)  <span class="co"># Cohen&#39;s d_s</span></span>
<span id="cb48-3"><a href="02-mean_difference.html#cb48-3" aria-hidden="true" tabindex="-1"></a>se_ds <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((m<span class="sc">+</span>n)<span class="sc">/</span>(m<span class="sc">*</span>n)<span class="sc">+</span>(ds<span class="sc">$</span>Cohens_d<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>(m<span class="sc">+</span>n))))</span>
<span id="cb48-4"><a href="02-mean_difference.html#cb48-4" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>Cohens_d <span class="sc">-</span> <span class="fl">1.96</span><span class="sc">*</span>se_ds  <span class="co"># 95%信頼区間の下限値</span></span></code></pre></div>
<pre><code>## [1] 0.9700153</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="02-mean_difference.html#cb50-1" aria-hidden="true" tabindex="-1"></a>ds<span class="sc">$</span>Cohens_d <span class="sc">+</span> <span class="fl">1.96</span><span class="sc">*</span>se_ds  <span class="co"># 95%信頼区間の上限値</span></span></code></pre></div>
<pre><code>## [1] 1.57803</code></pre>
<p>しかし、これは簡易的な方法であって、正確ではない。より正確な方法としては次の2種類がある。</p>
</div>
<div id="非心ｔ分布に基づく方法" class="section level4 hasAnchor" number="3.1.5.2">
<h4><span class="header-section-number">3.1.5.2</span> 非心ｔ分布に基づく方法<a href="02-mean_difference.html#非心ｔ分布に基づく方法" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>2つ目は、非心ｔ分布を用いる方法である。これは、以下の式で計算される検定統計量<span class="math inline">\(t\)</span>が帰無仮説が偽のときに、非心度<span class="math inline">\(λ\)</span>、自由度<span class="math inline">\(df\)</span>の非心ｔ分布に従うことを利用する方法である。</p>
<p><span class="math display">\[
t=d_s*\sqrt{\frac{mn}{m+n}},\\
\lambda=\delta*\sqrt{\frac{mn}{m+n}},\\
\delta=\lambda*\sqrt{\frac{m+n}{mn}},\\
df=m+n-2
\]</span></p>
<p>今回の例の場合、自由度<span class="math inline">\(df=198\)</span>の非心ｔ分布を非心度<span class="math inline">\(λ\)</span>を変えながら描いていったとき、検定統計量<span class="math inline">\(t\)</span>の実現値<span class="math inline">\(t=9.008702\)</span>が上側確率0.975に一致する非心度<span class="math inline">\(λ_L\)</span>を求める。そして、それに<span class="math inline">\(\sqrt{\frac{m+n}{mn}}\)</span> をかけることで効果量<span class="math inline">\(\delta\)</span>に変換したものが効果量<span class="math inline">\(d_s\)</span>の信頼区間の上限値になる。同様に、検定統計量<span class="math inline">\(t\)</span>の実現値が非心ｔ分布の下側確率0.025に一致する非心度<span class="math inline">\(λ_H\)</span>を求めて変換すれば効果量<span class="math inline">\(d_s\)</span>の信頼区間の下限値になる。非心ｔ分布の詳細については、<span class="citation">(<a href="#ref-haebara2014" role="doc-biblioref">南風原朝和, 2014</a>)</span>などを参照されたい。※Glass’s <span class="math inline">\(\Delta\)</span> の場合は、自由度<span class="math inline">\(df\)</span>を<span class="math inline">\(n-1\)</span>とする。</p>
<p>Rを利用すれば、Cohen’s <span class="math inline">\(d_s\)</span> の95%信頼区間は以下のように求められる。</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="02-mean_difference.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb52-2"><a href="02-mean_difference.html#cb52-2" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="fu">cohens_d</span>(A, B)  <span class="co"># Cohen&#39;s d_s</span></span>
<span id="cb52-3"><a href="02-mean_difference.html#cb52-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> ds<span class="sc">$</span>Cohens_d<span class="sc">*</span><span class="fu">sqrt</span>(m<span class="sc">*</span>n<span class="sc">/</span>(m<span class="sc">+</span>n)) <span class="co"># t値</span></span>
<span id="cb52-4"><a href="02-mean_difference.html#cb52-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> m<span class="sc">+</span>n<span class="dv">-2</span> <span class="co"># 自由度</span></span>
<span id="cb52-5"><a href="02-mean_difference.html#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MBESS)</span>
<span id="cb52-6"><a href="02-mean_difference.html#cb52-6" aria-hidden="true" tabindex="-1"></a>lambda.ci <span class="ot">&lt;-</span> <span class="fu">conf.limits.nct</span>(<span class="at">t.value=</span>t, <span class="at">df=</span>df, <span class="at">conf.level =</span> .<span class="dv">95</span>) <span class="co"># 非心t分布の95%点</span></span>
<span id="cb52-7"><a href="02-mean_difference.html#cb52-7" aria-hidden="true" tabindex="-1"></a>lambda.ci<span class="sc">$</span>Lower.Limit<span class="sc">*</span><span class="fu">sqrt</span>((m<span class="sc">+</span>n)<span class="sc">/</span>(m<span class="sc">*</span>n))  <span class="co"># 95%信頼区間の下限値</span></span></code></pre></div>
<pre><code>## [1] 0.968447</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="02-mean_difference.html#cb54-1" aria-hidden="true" tabindex="-1"></a>lambda.ci<span class="sc">$</span>Upper.Limit<span class="sc">*</span><span class="fu">sqrt</span>((m<span class="sc">+</span>n)<span class="sc">/</span>(m<span class="sc">*</span>n))  <span class="co"># 95%信頼区間の上限値</span></span></code></pre></div>
<pre><code>## [1] 1.576903</code></pre>
<p>既存のパッケージを利用した場合でも同様の結果が得られる。</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="02-mean_difference.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb56-2"><a href="02-mean_difference.html#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cohens_d</span>(A, B)  <span class="co"># Cohen&#39;s d_s</span></span></code></pre></div>
<pre><code>## Cohen&#39;s d |       95% CI
## ------------------------
## 1.27      | [0.97, 1.58]
## 
## - Estimated using pooled SD.</code></pre>
<p>ただし、この方法ではGlassの <span class="math inline">\(\Delta\)</span> の信頼区間を求めることができない（等分散の場合を除く）。その場合、次に示すブートストラップ法を用いる。</p>
</div>
<div id="ブートストラップ法" class="section level4 hasAnchor" number="3.1.5.3">
<h4><span class="header-section-number">3.1.5.3</span> ブートストラップ法<a href="02-mean_difference.html#ブートストラップ法" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>3つ目は、ブートストラップ法を用いる方法である。ブートストラップ法とは、標本からの復元抽出を繰り返すことで大きな標本を生成し、そこから得られる近似分布（経験分布）によって標準誤差や信頼区間を求める方法である。ブートストラップ法では、母集団分布を仮定せずに信頼区間を計算することができるため便利である。</p>
<p>ここでは既存のパッケージを利用して、Cohen’s <span class="math inline">\(d_s\)</span> の95%信頼区間を求める。R=10000回の復元抽出を行うよう設定している。</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="02-mean_difference.html#cb58-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">score=</span><span class="fu">append</span>(A, B), <span class="at">group=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="at">each=</span><span class="dv">100</span>))</span>
<span id="cb58-2"><a href="02-mean_difference.html#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootES)</span>
<span id="cb58-3"><a href="02-mean_difference.html#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb58-4"><a href="02-mean_difference.html#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="fu">bootES</span>(<span class="at">data =</span> dat, <span class="at">data.col =</span> <span class="st">&quot;score&quot;</span>, <span class="at">group.col =</span> <span class="st">&quot;group&quot;</span>, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>,<span class="st">&quot;A&quot;</span>), </span>
<span id="cb58-5"><a href="02-mean_difference.html#cb58-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">effect.type =</span> <span class="st">&quot;cohens.d&quot;</span>, <span class="at">ci.conf =</span> <span class="fl">0.95</span>, <span class="at">R =</span> <span class="dv">10000</span>)</span></code></pre></div>
<pre><code>## 
## User-specified lambdas: (B, A)
## Scaled lambdas: (-1, 1)
## 95.00% bca Confidence Interval, 10000 replicates
## Stat        CI (Low)    CI (High)   bias        SE          
## 1.274       0.931       1.602       0.014       0.172</code></pre>
<p>Glassの <span class="math inline">\(\Delta\)</span> の95%信頼区間も以下のように求められる。</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="02-mean_difference.html#cb60-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">score=</span><span class="fu">append</span>(A, B), <span class="at">group=</span><span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>), <span class="at">each=</span><span class="dv">100</span>))</span>
<span id="cb60-2"><a href="02-mean_difference.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bootES)</span>
<span id="cb60-3"><a href="02-mean_difference.html#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb60-4"><a href="02-mean_difference.html#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="fu">bootES</span>(<span class="at">data =</span> dat, <span class="at">data.col =</span> <span class="st">&quot;score&quot;</span>, <span class="at">group.col =</span> <span class="st">&quot;group&quot;</span>, <span class="at">contrast =</span> <span class="fu">c</span>(<span class="st">&quot;B&quot;</span>,<span class="st">&quot;A&quot;</span>), </span>
<span id="cb60-5"><a href="02-mean_difference.html#cb60-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">effect.type =</span> <span class="st">&quot;cohens.d&quot;</span>, <span class="at">glass.control =</span> <span class="st">&quot;B&quot;</span>, <span class="at">ci.conf =</span> <span class="fl">0.95</span>, <span class="at">R =</span> <span class="dv">10000</span>)</span></code></pre></div>
<pre><code>## 
## User-specified lambdas: (B, A)
## Scaled lambdas: (-1, 1)
## 95.00% bca Confidence Interval, 10000 replicates
## Stat        CI (Low)    CI (High)   bias        SE          
## 1.239       0.856       1.612       0.023       0.196</code></pre>
</div>
</div>
<div id="ベイズ統計に基づくアプローチ-1" class="section level3 hasAnchor" number="3.1.6">
<h3><span class="header-section-number">3.1.6</span> ベイズ統計に基づくアプローチ<a href="02-mean_difference.html#ベイズ統計に基づくアプローチ-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>ベイズ統計に基づき、母効果量とその信用区間について推論する方法を紹介する。なお、ここでの説明は、<a href="https://sucre-stat.com/2021/06/bayesian-hypothesis-testing-2theory/" class="uri">https://sucre-stat.com/2021/06/bayesian-hypothesis-testing-2theory/</a> を参考にした。</p>
<p>いま、2つの独立した母集団A, Bから抽出した2標本がそれぞれ以下のように正規分布に従うとする。ここでは、それぞれの正規分布の平均が2群に共通した母平均 <span class="math inline">\(\mu\)</span> からどれだけ離れているかを母効果量パラメータ <span class="math inline">\(\delta\)</span> を組み込んで表現している。また、群間で分散は共通であると仮定している。</p>
<p><span class="math display">\[
\begin{cases}
A_i \sim \mathcal{N}\left(\mu - \cfrac{\delta \sigma}{2}, \sigma^2\right),~~~i=1,\ldots,m \\
B_j \sim \mathcal{N}\left(\mu + \cfrac{\delta \sigma}{2}, \sigma^2\right),~~~j=1,\ldots,n
\end{cases}
\]</span></p>
<p>各パラメータの事前分布を以下のように設定する。これは、Jeffreys-Zellner-Siow（JZS）の事前分布と呼ばれるジェフリーズ事前分布の一種である。今回は、<span class="math inline">\(r=1/\sqrt{2}\)</span> とする。</p>
<p><span class="math display">\[
\begin{cases}
\delta \sim \mathrm{Cauchy}(0,r) \\
\pi\left(\sigma^2\right) ∝ \cfrac{1}{\sigma^2} \\
\pi\left(\mu\right) ∝ 1
\end{cases}
\]</span></p>
<p>JZSの事前分布を用いた場合の母効果量 <span class="math inline">\(\delta\)</span> の事後分布の式については割愛するが、以下のRコードでのMAP推定値と信用区間を求めることができる。</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="02-mean_difference.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb62-2"><a href="02-mean_difference.html#cb62-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">60</span>, <span class="dv">10</span>)</span>
<span id="cb62-3"><a href="02-mean_difference.html#cb62-3" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb62-4"><a href="02-mean_difference.html#cb62-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-5"><a href="02-mean_difference.html#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(BayesFactor)</span>
<span id="cb62-6"><a href="02-mean_difference.html#cb62-6" aria-hidden="true" tabindex="-1"></a>bf <span class="ot">&lt;-</span> <span class="fu">ttestBF</span>(A, B, <span class="at">paired =</span> F) <span class="co"># ベイズファクター BF_10</span></span>
<span id="cb62-7"><a href="02-mean_difference.html#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayestestR)</span>
<span id="cb62-8"><a href="02-mean_difference.html#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="fu">describe_prior</span>(bf) <span class="co"># 事前分布</span></span></code></pre></div>
<pre><code>##    Parameter Prior_Distribution Prior_Location Prior_Scale
## 1 Difference             cauchy              0   0.7071068</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="02-mean_difference.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">effectsize</span>(bf, <span class="at">test =</span> <span class="cn">NULL</span>) <span class="co"># 事後分布における効果量のMAP推定値</span></span></code></pre></div>
<pre><code>## Cohen&#39;s d |       95% CI
## ------------------------
## 1.25      | [0.94, 1.56]</code></pre>
</div>
<div id="結果の報告-1" class="section level3 hasAnchor" number="3.1.7">
<h3><span class="header-section-number">3.1.7</span> 結果の報告<a href="02-mean_difference.html#結果の報告-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>標準化平均値差を報告する際には、以下の4点を報告すればよい。</p>
<ol style="list-style-type: decimal">
<li>効果の方向（2つの集団のどちらからどちらを引いたか。値が正の場合はどちらの集団が大きいことになるか。）</li>
<li>効果量の種類（<span class="math inline">\(d, d_S, \Delta\)</span> など）</li>
<li>効果量の点推定値</li>
<li>推定の不確実性（95%信頼区間など）</li>
</ol>
<p>Rを用いて以下のように結果報告の表や文章を出力することもできる。</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="02-mean_difference.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb66-2"><a href="02-mean_difference.html#cb66-2" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">60</span>, <span class="dv">10</span>)</span>
<span id="cb66-3"><a href="02-mean_difference.html#cb66-3" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">100</span>, <span class="dv">50</span>, <span class="dv">10</span>)</span>
<span id="cb66-4"><a href="02-mean_difference.html#cb66-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-5"><a href="02-mean_difference.html#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb66-6"><a href="02-mean_difference.html#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">report_table</span>(<span class="fu">t.test</span>(A, B, <span class="at">var.equal =</span> T)) <span class="co"># 表</span></span></code></pre></div>
<pre><code>## Parameter1 | Parameter2 | Mean_Parameter1 | Mean_Parameter2 | Difference |        95% CI | t(198) |      p |            Method | Alternative | Cohen&#39;s d | Cohens_d  CI
## -----------------------------------------------------------------------------------------------------------------------------------------------------------------------
## A          |          B |           60.90 |           48.92 |      11.98 | [9.36, 14.60] |   9.01 | &lt; .001 | Two Sample t-test |   two.sided |      1.27 | [0.97, 1.58]</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="02-mean_difference.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(<span class="fu">t.test</span>(A, B, <span class="at">var.equal =</span> T)) <span class="co"># 文章</span></span></code></pre></div>
<pre><code>## Effect sizes were labelled following Cohen&#39;s (1988) recommendations.
## 
## The Two Sample t-test testing the difference between A and B (mean of x = 60.90, mean of y = 48.92) suggests that the effect is positive, statistically significant, and large (difference = 11.98, 95% CI [9.36, 14.60], t(198) = 9.01, p &lt; .001; Cohen&#39;s d = 1.27, 95% CI [0.97, 1.58])</code></pre>
</div>
</div>
<div id="対応のある2群の平均値差" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> 対応のある2群の平均値差<a href="02-mean_difference.html#対応のある2群の平均値差" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>同一集団に対する2回の測定を行う状況を考える（プレ・ポストデザイン）。いま、下記の二変量正規分布に独立に従うn=100の2組（プレ・ポスト）の標本を得たとする。これは、プレの母平均が50、母分散が100、ポストの母平均が60、母分散が100、プレ・ポストの母相関が0.5であることを意味している。</p>
<p><span class="math display">\[
\begin{pmatrix} X_{pre} \\ X_{post} \end{pmatrix} \sim MultiNormal \left( \boldsymbol{\mu}, \boldsymbol{\Sigma} \right),\\
\boldsymbol{\mu} = \begin{pmatrix} 50 \\ 60 \end{pmatrix},
\boldsymbol{\Sigma} = \begin{pmatrix} 100 &amp; 50 \\
50 &amp; 100 \end{pmatrix}\\
\]</span></p>
<p>2つの測定値の差も正規分布に従う。</p>
<p><span class="math display">\[
X_{post}-X_{pre}\sim Normal(10, 100)
\]</span></p>
<p>Rを使って上記の分布に従う乱数を発生させてみよう。このデータを用いて後に示す効果量を計算していく。</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="02-mean_difference.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mvtnorm)</span>
<span id="cb70-2"><a href="02-mean_difference.html#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb70-3"><a href="02-mean_difference.html#cb70-3" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">50</span>,<span class="dv">50</span>,<span class="dv">100</span>), <span class="at">byrow=</span><span class="cn">TRUE</span>, <span class="at">ncol=</span><span class="dv">2</span>) </span>
<span id="cb70-4"><a href="02-mean_difference.html#cb70-4" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">50</span>, <span class="dv">60</span>)</span>
<span id="cb70-5"><a href="02-mean_difference.html#cb70-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb70-6"><a href="02-mean_difference.html#cb70-6" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">rmvnorm</span>(<span class="at">n=</span>n, <span class="at">mean=</span>mu, <span class="at">sigma=</span>sigma)) </span>
<span id="cb70-7"><a href="02-mean_difference.html#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(dat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;pre&quot;</span>,<span class="st">&quot;post&quot;</span>)</span></code></pre></div>
<div id="非標準化平均値差-1" class="section level3 hasAnchor" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> 非標準化平均値差<a href="02-mean_difference.html#非標準化平均値差-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>プレ・ポストの平均値差Dは、以下の式で求められる。これは非標準化効果量の一種であり、元の測定単位における比較に関心がある場合などに有用である。 <span class="math display">\[
D=\bar{x}_{post}-\bar{x}_{pre}
\]</span> 誤差分散は以下の式で求められる。<span class="math inline">\(\hat\sigma^2_{pre}\)</span> はプレの標準偏差、<span class="math inline">\(\hat\sigma^2_{post}\)</span> はポストの標準偏差、<span class="math inline">\(r\)</span> はプレとポストの相関係数を指す。 <span class="math display">\[
V_D=\frac{\hat\sigma^2_{pre}+\hat\sigma^2_{post}-(2r*\hat\sigma^2_{pre}*\hat\sigma^2_{post})}{n}
\]</span></p>
</div>
<div id="標準化平均値差-1" class="section level3 hasAnchor" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> 標準化平均値差<a href="02-mean_difference.html#標準化平均値差-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>対応のある2群の平均値差の標準化効果量として、対応の無い場合の標準化効果量を用いる方法もある。しかしながら、これはプレ・ポストの相関を考慮しておらず、相関の大きさに関係なく常に一定の値になる。これは対応のあるｔ検定の結果とも対応しないことからやや不自然である。</p>
<p>そこで、相関を考慮した効果量として新たに以下のような母効果量を定義する<span class="citation">(<a href="#ref-kline2004" role="doc-biblioref">Kline, 2004, p. 106</a>)</span>。ここで、<span class="math inline">\(\mu_{D}\)</span> はプレ・ポストの差の期待値、<span class="math inline">\(σ_D\)</span> はプレ・ポストの平均値差の母標準偏差、 <span class="math inline">\(σ\)</span> はプレ・ポストで共通な母標準偏差である。</p>
<p><span class="math display">\[
\delta_p=\frac{\mu_{D}}{\sigma_D}=\frac{\mu_{D}}{\sigma\sqrt{2(1-\rho)}}
\]</span> <span class="math inline">\(\delta\)</span> と <span class="math inline">\(\delta_p\)</span> では分母の計算式が異なる。 <span class="math inline">\(\delta_p\)</span> の場合、プレ・ポストの相関を含む平方根が新たに加わっている。式から分かる通り、同じ平均値差の場合、相関が大きくなるほど効果量も大きくなる。相関が大きいことは言い換えれば平均値差の標準偏差が小さいことを意味する。</p>
<p>また、相関の絶対値が0.5のとき、<span class="math inline">\(\delta\)</span> と <span class="math inline">\(\delta_p\)</span> は一致する。<span class="math inline">\(\delta_p\)</span> に <span class="math inline">\(\sqrt{2(1-\rho)}\)</span> をかければ <span class="math inline">\(\delta\)</span> に変換できる。</p>
<div id="cohens-d_z" class="section level4 hasAnchor" number="3.2.2.1">
<h4><span class="header-section-number">3.2.2.1</span> Cohen’s <span class="math inline">\(d_z\)</span><a href="02-mean_difference.html#cohens-d_z" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>母効果量 <span class="math inline">\(\delta_p\)</span> の推定量である標本効果量としては、Cohen の <span class="math inline">\(d_z\)</span> がある。 これは、プレ・ポストの平均値差を平均値差の標準偏差で割ることで得られる<span class="citation">(<a href="#ref-cohen1988" role="doc-biblioref">Cohen, 1988, p. 48</a>)</span>。ここで、<span class="math inline">\(\hat\sigma_D\)</span> は平均値差の標準偏差、<span class="math inline">\(\hat\sigma_A^2\)</span> は群Aの不偏分散、<span class="math inline">\(\hat\sigma_B^2\)</span> は群Bの不偏分差を指す。zという添え字は、<span class="citation">Cohen (<a href="#ref-cohen1988" role="doc-biblioref">1988</a>)</span> がXとYの差をZと表現したことに由来する。 <span class="math display">\[
D=\bar{x}_{post}-\bar{x}_{pre}\\
Cohen&#39;s~d_z=\frac{D}{\hat\sigma_D}=\frac{D}{\sqrt{\hat\sigma_{pre}^2+\hat\sigma_{post}^2-2*cov(x_{pre}, x_{post})}}
\]</span> 誤差分散は以下の式で求められる。ここで、<span class="math inline">\(r\)</span> は、プレとポストの相関係数を指す。</p>
<p><span class="math display">\[
V_{d_z} = \dfrac{2(1-r)}{n}+\frac{d_z^2}{2n}
\]</span></p>
<p>Rを利用すれば、Cohen の <span class="math inline">\(d_z\)</span> は以下のように計算できる。</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="02-mean_difference.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(dat<span class="sc">$</span>post<span class="sc">-</span>dat<span class="sc">$</span>pre)<span class="sc">/</span><span class="fu">sd</span>(dat<span class="sc">$</span>post<span class="sc">-</span>dat<span class="sc">$</span>pre)</span></code></pre></div>
<pre><code>## [1] 0.9587383</code></pre>
<p>既存のパッケージを利用した場合でも同様の結果が得られる。</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="02-mean_difference.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb73-2"><a href="02-mean_difference.html#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cohens_d</span>(dat<span class="sc">$</span>post, dat<span class="sc">$</span>pre, <span class="at">paired =</span> T) <span class="co"># Cohen&#39;s d_z</span></span></code></pre></div>
<pre><code>## Cohen&#39;s d |       95% CI
## ------------------------
## 0.96      | [0.72, 1.20]</code></pre>
</div>
</div>
<div id="信頼区間-1" class="section level3 hasAnchor" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> 信頼区間<a href="02-mean_difference.html#信頼区間-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>対応のある2群の平均値差の効果量の信頼区間の計算についても、独立した2群の場合と同様の3種類の方法が使用できる。ここでは、非心ｔ分布に基づく方法のみ紹介する。これは、以下の式で計算される検定統計量ｔが帰無仮説が偽のときに、非心度<span class="math inline">\(λ\)</span>、自由度<span class="math inline">\(df\)</span>の非心ｔ分布に従うことを利用する方法である。</p>
<p><span class="math display">\[
t=d_z*\sqrt{n},\\
\lambda=\delta*\sqrt{n},\\
df=n-1
\]</span>
今回の例の場合、自由度<span class="math inline">\(df=99\)</span>の非心ｔ分布を非心度<span class="math inline">\(λ\)</span>を変えながら描いていったとき、検定統計量<span class="math inline">\(t\)</span>の実現値<span class="math inline">\(t=9.587383\)</span>が上側確率0.975に一致する非心度<span class="math inline">\(λ_L\)</span>を求める。そして、それに<span class="math inline">\(\sqrt{n}\)</span>をかけることで効果量<span class="math inline">\(\delta\)</span>に変換したものが効果量<span class="math inline">\(d_s\)</span>の信頼区間の上限値になる。同様に、検定統計量<span class="math inline">\(t\)</span>の実現値が非心ｔ分布の下側確率0.025に一致する非心度<span class="math inline">\(λ_H\)</span>を求めて変換すれば効果量<span class="math inline">\(d_s\)</span>の信頼区間の下限値になる。非心ｔ分布の詳細については、<span class="citation">(<a href="#ref-haebara2014" role="doc-biblioref">南風原朝和, 2014</a>)</span>などを参照されたい。</p>
<p>Rを利用すれば、Cohen’s <span class="math inline">\(d_s\)</span> の95%信頼区間は以下のように求められる。</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="02-mean_difference.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb75-2"><a href="02-mean_difference.html#cb75-2" aria-hidden="true" tabindex="-1"></a>dz <span class="ot">&lt;-</span> <span class="fu">cohens_d</span>(dat<span class="sc">$</span>post, dat<span class="sc">$</span>pre, <span class="at">paired =</span> T) <span class="co"># Cohen&#39;s d_z</span></span>
<span id="cb75-3"><a href="02-mean_difference.html#cb75-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> dz<span class="sc">$</span>Cohens_d<span class="sc">*</span><span class="fu">sqrt</span>(n) <span class="co"># t値</span></span>
<span id="cb75-4"><a href="02-mean_difference.html#cb75-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> n<span class="dv">-1</span> <span class="co"># 自由度</span></span>
<span id="cb75-5"><a href="02-mean_difference.html#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MBESS)</span>
<span id="cb75-6"><a href="02-mean_difference.html#cb75-6" aria-hidden="true" tabindex="-1"></a>lambda.ci <span class="ot">&lt;-</span> <span class="fu">conf.limits.nct</span>(<span class="at">t.value =</span> t, <span class="at">df=</span>df, <span class="at">conf.level =</span> .<span class="dv">95</span>) <span class="co"># 非心t分布の95%点</span></span>
<span id="cb75-7"><a href="02-mean_difference.html#cb75-7" aria-hidden="true" tabindex="-1"></a>lambda.ci<span class="sc">$</span>Lower.Limit<span class="sc">/</span><span class="fu">sqrt</span>(n)  <span class="co"># 95%信頼区間の下限値</span></span></code></pre></div>
<pre><code>## [1] 0.719982</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="02-mean_difference.html#cb77-1" aria-hidden="true" tabindex="-1"></a>lambda.ci<span class="sc">$</span>Upper.Limit<span class="sc">/</span><span class="fu">sqrt</span>(n)  <span class="co"># 95%信頼区間の上限値</span></span></code></pre></div>
<pre><code>## [1] 1.194118</code></pre>
<p>既存のパッケージを利用した場合でも同様の結果が得られる。</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="02-mean_difference.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb79-2"><a href="02-mean_difference.html#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cohens_d</span>(dat<span class="sc">$</span>post, dat<span class="sc">$</span>pre, <span class="at">paired =</span> T) <span class="co"># Cohen&#39;s d_z</span></span></code></pre></div>
<pre><code>## Cohen&#39;s d |       95% CI
## ------------------------
## 0.96      | [0.72, 1.20]</code></pre>
</div>
<div id="結果の報告-2" class="section level3 hasAnchor" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> 結果の報告<a href="02-mean_difference.html#結果の報告-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>対応のある2群の標準化平均値差を報告する際には、以下の5点を報告すればよい。</p>
<ol style="list-style-type: decimal">
<li>効果の方向（値が正の場合はプレとポストのどちらが大きいことになるか。）</li>
<li>効果量の種類（<span class="math inline">\(d_z\)</span> など）</li>
<li>効果量の点推定値</li>
<li>推定の不確実性（95%信頼区間など）</li>
<li>プレとポストの相関係数r</li>
</ol>
<p>Rを用いて以下のように結果報告の表や文章を出力することもできる。</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="02-mean_difference.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(report)</span>
<span id="cb81-2"><a href="02-mean_difference.html#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">report_table</span>(<span class="fu">t.test</span>(dat<span class="sc">$</span>post, dat<span class="sc">$</span>pre, <span class="at">paired =</span> T)) <span class="co"># 表</span></span></code></pre></div>
<pre><code>## Parameter |   Group | Difference | t(99) |      p |        95% CI |        Method | Alternative | Cohen&#39;s d | Cohens_d  CI
## --------------------------------------------------------------------------------------------------------------------------
## dat$post  | dat$pre |       9.80 |  9.59 | &lt; .001 | [7.77, 11.82] | Paired t-test |   two.sided |      0.96 | [0.72, 1.20]</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="02-mean_difference.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">report</span>(<span class="fu">t.test</span>(dat<span class="sc">$</span>post, dat<span class="sc">$</span>pre, <span class="at">paired =</span> T)) <span class="co"># 文章</span></span></code></pre></div>
<pre><code>## Effect sizes were labelled following Cohen&#39;s (1988) recommendations.
## 
## The Paired t-test testing the difference between dat$post and dat$pre (mean difference = 9.80) suggests that the effect is positive, statistically significant, and large (difference = 9.80, 95% CI [7.77, 11.82], t(99) = 9.59, p &lt; .001; Cohen&#39;s d = 0.96, 95% CI [0.72, 1.20])</code></pre>
</div>
</div>
<div id="標準化平均値差の補正" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> 標準化平均値差の補正<a href="02-mean_difference.html#標準化平均値差の補正" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>標本から得られた統計量を用いて母効果量の推定値を算出する際に特定のバイアスが生じることが予想される場合、バイアスの原因に応じた補正を行うことが考えられる。ここでは、1．小標本の補正、2．信頼性の補正、3．範囲制限の補正を順に紹介する。</p>
<div id="小標本の補正" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> 小標本の補正<a href="02-mean_difference.html#小標本の補正" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>1つ目の補正は小標本の補正である。これまでに紹介した標準化平均値差の効果量には母効果量の推定におけるバイアスが存在し、特に標本が小さい時に顕著である。このバイアスを補正する方法として、標本効果量に以下の補正係数を乗じる方法が提案されている。ここで、<span class="math inline">\(df\)</span> は自由度を表す。 <span class="math display">\[
J\approx1-\frac{3}{4*df-1}
\]</span></p>
<div id="hedges-g" class="section level4 hasAnchor" number="3.3.1.1">
<h4><span class="header-section-number">3.3.1.1</span> Hedges’ <span class="math inline">\(g\)</span><a href="02-mean_difference.html#hedges-g" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>補正係数 <span class="math inline">\(J\)</span> をCohen’s <span class="math inline">\(d_s\)</span>に乗じることで、バイアスの補正された効果量が得られる。mとnは各群のサンプルサイズである。これは Hedges’ <span class="math inline">\(g\)</span> と呼ばれ、母効果量 <span class="math inline">\(\delta\)</span> の不偏推定量である<span class="citation">(<a href="#ref-hedges1981" role="doc-biblioref">Hedges, 1981</a>)</span>。</p>
<p><span class="math display">\[
J\approx1-\frac{3}{4(m+n-2)-1}\\
Heges&#39;~g=J*d_s
\]</span> Rを利用すれば、Hedges の <span class="math inline">\(g\)</span> は以下のように計算できる。</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="02-mean_difference.html#cb85-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span> ; n <span class="ot">&lt;-</span> <span class="dv">100</span>   <span class="co"># サンプルサイズ</span></span>
<span id="cb85-2"><a href="02-mean_difference.html#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)         <span class="co"># 乱数の種の固定</span></span>
<span id="cb85-3"><a href="02-mean_difference.html#cb85-3" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m, <span class="dv">60</span>, <span class="dv">10</span>) <span class="co"># 正規分布N(50,100)からm個の乱数を発生</span></span>
<span id="cb85-4"><a href="02-mean_difference.html#cb85-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>) <span class="co"># 正規分布N(60,100)からn個の乱数を発生</span></span>
<span id="cb85-5"><a href="02-mean_difference.html#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb85-6"><a href="02-mean_difference.html#cb85-6" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">cohens_d</span>(A, B)   <span class="co"># Cohen&#39;s d_s</span></span>
<span id="cb85-7"><a href="02-mean_difference.html#cb85-7" aria-hidden="true" tabindex="-1"></a>d<span class="sc">$</span>Cohens_d <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>(<span class="dv">3</span><span class="sc">/</span>(<span class="dv">4</span><span class="sc">*</span>(m<span class="sc">+</span>n<span class="dv">-2</span>)<span class="sc">-</span><span class="dv">1</span>))) <span class="co"># Hedges&#39; g</span></span></code></pre></div>
<pre><code>## [1] 1.269191</code></pre>
<p>既存のパッケージを利用した場合でも同様の結果が得られる。</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="02-mean_difference.html#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb87-2"><a href="02-mean_difference.html#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">hedges_g</span>(A, B)</span></code></pre></div>
<pre><code>## Hedges&#39; g |       95% CI
## ------------------------
## 1.27      | [0.96, 1.57]
## 
## - Estimated using pooled SD.</code></pre>
</div>
<div id="glsss-delta_adj" class="section level4 hasAnchor" number="3.3.1.2">
<h4><span class="header-section-number">3.3.1.2</span> Glss’s <span class="math inline">\(\Delta_{adj}\)</span><a href="02-mean_difference.html#glsss-delta_adj" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>補正係数 <span class="math inline">\(J\)</span> をGlass’s <span class="math inline">\(\Delta\)</span> に乗じることで、バイアスの補正された効果量 Glass’s <span class="math inline">\(\Delta_{adj}\)</span>が得られる<span class="citation">(<a href="#ref-grissom2005" role="doc-biblioref">Grissom &amp; Kim, 2005, p. 54</a>)</span>。nは統制群のサンプルサイズである。</p>
<p><span class="math display">\[
J\approx1-\frac{3}{4(n-1)-1}\\
Glass&#39;s~\Delta_{adj}=J*\Delta
\]</span></p>
<p>Rを利用すれば、Glass の <span class="math inline">\(\Delta_{adj}\)</span> は以下のように計算できる。</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="02-mean_difference.html#cb89-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span> ; n <span class="ot">&lt;-</span> <span class="dv">100</span>   <span class="co"># サンプルサイズ</span></span>
<span id="cb89-2"><a href="02-mean_difference.html#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)         <span class="co"># 乱数の種の固定</span></span>
<span id="cb89-3"><a href="02-mean_difference.html#cb89-3" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m, <span class="dv">60</span>, <span class="dv">12</span>) <span class="co"># 正規分布N(50,144)からm個の乱数を発生</span></span>
<span id="cb89-4"><a href="02-mean_difference.html#cb89-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>) <span class="co"># 正規分布N(60,100)からn個の乱数を発生</span></span>
<span id="cb89-5"><a href="02-mean_difference.html#cb89-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb89-6"><a href="02-mean_difference.html#cb89-6" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="fu">glass_delta</span>(A, B)  <span class="co"># Glass&#39;s delta</span></span>
<span id="cb89-7"><a href="02-mean_difference.html#cb89-7" aria-hidden="true" tabindex="-1"></a>delta<span class="sc">$</span>Glass_delta <span class="sc">*</span> (<span class="dv">1</span><span class="sc">-</span>(<span class="dv">3</span><span class="sc">/</span>(<span class="dv">4</span><span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">-</span><span class="dv">1</span>))) <span class="co"># Glass&#39;s delta_adjusted</span></span></code></pre></div>
<pre><code>## [1] 1.247999</code></pre>
<p>既存のパッケージを利用した場合でも同様の結果が得られる。わずかに数値がずれるのは、<code>psychmeta</code>パッケージがガンマ関数を利用したより正確な補正係数の計算法を採用しているためである。</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="02-mean_difference.html#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb91-2"><a href="02-mean_difference.html#cb91-2" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="fu">glass_delta</span>(A, B)  <span class="co"># Glass&#39;s delta</span></span>
<span id="cb91-3"><a href="02-mean_difference.html#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psychmeta)</span>
<span id="cb91-4"><a href="02-mean_difference.html#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="fu">correct_glass_bias</span>(delta<span class="sc">$</span>Glass_delta, <span class="at">nc=</span>n, <span class="at">ne=</span>m)</span></code></pre></div>
<pre><code>## [1] 1.247995</code></pre>
</div>
<div id="シミュレーション" class="section level4 hasAnchor" number="3.3.1.3">
<h4><span class="header-section-number">3.3.1.3</span> シミュレーション<a href="02-mean_difference.html#シミュレーション" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>これまでに紹介した平均値差の標本効果量が母効果量の推定値としてどのような性質を持つのかをシミュレーションによって確認しよう。以下のコードでは、各効果量について結果格納用の箱を作った上で、任意のサンプルサイズ<span class="math inline">\(n\)</span>で効果量を算出する計算を10000回繰り返している。母効果量は <span class="math inline">\(\delta=1\)</span> であることから、バイアスが無ければ10000個の効果量の平均（期待値）と<span class="math inline">\(\delta=1\)</span>の差は0に近づくはずである（i.e., 不偏性）。</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="02-mean_difference.html#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb93-2"><a href="02-mean_difference.html#cb93-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="cn">NULL</span>     <span class="co"># Hedged &amp; Olkin&#39;s d の箱</span></span>
<span id="cb93-3"><a href="02-mean_difference.html#cb93-3" aria-hidden="true" tabindex="-1"></a>ds <span class="ot">&lt;-</span> <span class="cn">NULL</span>    <span class="co"># Cohen&#39;s d_s の箱</span></span>
<span id="cb93-4"><a href="02-mean_difference.html#cb93-4" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="cn">NULL</span>     <span class="co"># Hedges&#39;g の箱</span></span>
<span id="cb93-5"><a href="02-mean_difference.html#cb93-5" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># Glass&#39;s delta の箱</span></span>
<span id="cb93-6"><a href="02-mean_difference.html#cb93-6" aria-hidden="true" tabindex="-1"></a>delta_adj <span class="ot">&lt;-</span> <span class="cn">NULL</span> <span class="co"># Glass&#39;s delta_adj の箱</span></span>
<span id="cb93-7"><a href="02-mean_difference.html#cb93-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">5</span>        <span class="co"># サンプルサイズ</span></span>
<span id="cb93-8"><a href="02-mean_difference.html#cb93-8" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10000</span>    <span class="co"># シミュレーション回数</span></span>
<span id="cb93-9"><a href="02-mean_difference.html#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb93-10"><a href="02-mean_difference.html#cb93-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k){</span>
<span id="cb93-11"><a href="02-mean_difference.html#cb93-11" aria-hidden="true" tabindex="-1"></a>  A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">60</span>, <span class="dv">10</span>) <span class="co"># 正規分布に従う乱数A</span></span>
<span id="cb93-12"><a href="02-mean_difference.html#cb93-12" aria-hidden="true" tabindex="-1"></a>  B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>) <span class="co"># 正規分布に従う乱数B</span></span>
<span id="cb93-13"><a href="02-mean_difference.html#cb93-13" aria-hidden="true" tabindex="-1"></a>  svA <span class="ot">&lt;-</span> <span class="fu">sum</span>((A<span class="sc">-</span><span class="fu">mean</span>(A))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>n <span class="co"># 標本分散A</span></span>
<span id="cb93-14"><a href="02-mean_difference.html#cb93-14" aria-hidden="true" tabindex="-1"></a>  svB <span class="ot">&lt;-</span> <span class="fu">sum</span>((B<span class="sc">-</span><span class="fu">mean</span>(B))<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span>n <span class="co"># 標本分散B</span></span>
<span id="cb93-15"><a href="02-mean_difference.html#cb93-15" aria-hidden="true" tabindex="-1"></a>  poolsd <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="sc">*</span>svA<span class="sc">+</span>n<span class="sc">*</span>svB)<span class="sc">/</span>(n<span class="sc">+</span>n)) <span class="co">#2群をプールした標準偏差</span></span>
<span id="cb93-16"><a href="02-mean_difference.html#cb93-16" aria-hidden="true" tabindex="-1"></a>  d[i] <span class="ot">&lt;-</span> (<span class="fu">mean</span>(A)<span class="sc">-</span><span class="fu">mean</span>(B))<span class="sc">/</span>poolsd <span class="co"># Hedged &amp; Olkin&#39;s d</span></span>
<span id="cb93-17"><a href="02-mean_difference.html#cb93-17" aria-hidden="true" tabindex="-1"></a>  ds[i] <span class="ot">&lt;-</span> <span class="fu">cohens_d</span>(A, B)<span class="sc">$</span>Cohens_d <span class="co"># Cohen&#39;s d_s</span></span>
<span id="cb93-18"><a href="02-mean_difference.html#cb93-18" aria-hidden="true" tabindex="-1"></a>  g[i] <span class="ot">&lt;-</span> <span class="fu">hedges_g</span>(A, B)<span class="sc">$</span>Hedges_g  <span class="co"># Hedges&#39;g</span></span>
<span id="cb93-19"><a href="02-mean_difference.html#cb93-19" aria-hidden="true" tabindex="-1"></a>  delta[i] <span class="ot">&lt;-</span> <span class="fu">glass_delta</span>(A, B)<span class="sc">$</span>Glass_delta    <span class="co"># Glass&#39;s delta</span></span>
<span id="cb93-20"><a href="02-mean_difference.html#cb93-20" aria-hidden="true" tabindex="-1"></a>  delta_adj[i] <span class="ot">&lt;-</span> delta[i]<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>(<span class="dv">3</span><span class="sc">/</span>(<span class="dv">4</span><span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">-</span><span class="dv">1</span>))) <span class="co"># Glass&#39;s delta_adj</span></span>
<span id="cb93-21"><a href="02-mean_difference.html#cb93-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb93-22"><a href="02-mean_difference.html#cb93-22" aria-hidden="true" tabindex="-1"></a><span class="co"># bias</span></span>
<span id="cb93-23"><a href="02-mean_difference.html#cb93-23" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mean</span>(d)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb93-24"><a href="02-mean_difference.html#cb93-24" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mean</span>(ds)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>) ; <span class="fu">round</span>(<span class="fu">mean</span>(g)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>)</span>
<span id="cb93-25"><a href="02-mean_difference.html#cb93-25" aria-hidden="true" tabindex="-1"></a><span class="fu">round</span>(<span class="fu">mean</span>(delta)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>) ; <span class="fu">round</span>(<span class="fu">mean</span>(delta_adj)<span class="sc">-</span><span class="dv">1</span>, <span class="dv">4</span>)</span></code></pre></div>
<p><span class="math inline">\(n\)</span> の値を変えながらK=10000回のシミュレーションを繰り返すと、以下のような結果が得られる。</p>
<table style="width:100%;">
<caption>標準化平均値差の効果量のバイアス</caption>
<colgroup>
<col width="17%" />
<col width="10%" />
<col width="12%" />
<col width="12%" />
<col width="10%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">EStype \ n</th>
<th align="left">5</th>
<th align="left">10</th>
<th align="left">20</th>
<th align="left">30</th>
<th align="left">50</th>
<th align="left">100</th>
<th align="left">1000</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">d</td>
<td align="left">0.2491</td>
<td align="left">0.0927</td>
<td align="left">0.0431</td>
<td align="left">0.0313</td>
<td align="left">0.0162</td>
<td align="left">0.0069</td>
<td align="left">0.0008</td>
</tr>
<tr class="even">
<td align="left">d_s</td>
<td align="left">0.1172</td>
<td align="left">0.0366</td>
<td align="left">0.0167</td>
<td align="left">0.0140</td>
<td align="left">0.0060</td>
<td align="left">0.0018</td>
<td align="left">0.0003</td>
</tr>
<tr class="odd">
<td align="left">g</td>
<td align="left">0.0085</td>
<td align="left">-0.0073</td>
<td align="left">-0.0035</td>
<td align="left">0.0008</td>
<td align="left">-0.0018</td>
<td align="left">-0.002</td>
<td align="left">-0.0001</td>
</tr>
<tr class="even">
<td align="left">delta</td>
<td align="left">0.2649</td>
<td align="left">0.0848</td>
<td align="left">0.0382</td>
<td align="left">0.0294</td>
<td align="left">0.0139</td>
<td align="left">0.0056</td>
<td align="left">-0.0007</td>
</tr>
<tr class="odd">
<td align="left">delta_adj</td>
<td align="left">0.0119</td>
<td align="left">-0.0082</td>
<td align="left">-0.0034</td>
<td align="left">0.0025</td>
<td align="left">-0.0016</td>
<td align="left">-0.0020</td>
<td align="left">-0.0000</td>
</tr>
</tbody>
</table>
<p>表より、補正係数を使用した<span class="math inline">\(g\)</span>や<span class="math inline">\(\Delta_{adj}\)</span>の方が補正係数を使用していない<span class="math inline">\(d_s\)</span>や<span class="math inline">\(\Delta\)</span>よりもバイアスが少ない（真値に近い）ことが読み取れる。特に、サンプルサイズが20以下の場合はその差が顕著であり、補正係数を使用した標本効果量の使用が望ましい<span class="citation">(<a href="#ref-kline2004" role="doc-biblioref">Kline, 2004</a>)</span>。</p>
</div>
</div>
<div id="信頼性の補正" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> 信頼性の補正<a href="02-mean_difference.html#信頼性の補正" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>測定の信頼性が低い場合、効果量が少なく見積もられる減衰が問題になる。この問題に対して、測定の信頼性が分かっていればそれに応じた補正を行うことが提案されている<span class="citation">(<a href="#ref-hunter2004" role="doc-biblioref">Hunter et al., 2004</a>)</span>。 標準化平均値差とその誤差分散については、以下の式で補正する。ここで、<span class="math inline">\(d_s\)</span> は Cohen の <span class="math inline">\(d_s\)</span>、<span class="math inline">\(r_{yy}\)</span> は測定の信頼性を表す。</p>
<p><span class="math display">\[
df=m+n-2, \\
h=\frac{df}{m}+\frac{df}{n},  \\
r_{pb}=\frac{d_s\sqrt{d_s^2+h}}{d_s^2+h}, \\
r_{pb_c}=\frac{r_{pb}}{\sqrt{r_{yy}}},\\
d_c=\frac{r_{pb_c}\sqrt{h}}{\sqrt{1-r_{pb_c}^2}}, \\
V_{d_c}=\frac{V_{d_s}}{r_{yy}}
\]</span>たとえば、標本A, Bに共通した測定の信頼性が0.7であった場合、標準化平均値差は以下のように補正できる。</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="02-mean_difference.html#cb94-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span> ; n <span class="ot">&lt;-</span> <span class="dv">100</span>   <span class="co"># サンプルサイズ</span></span>
<span id="cb94-2"><a href="02-mean_difference.html#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)         <span class="co"># 乱数の種の固定</span></span>
<span id="cb94-3"><a href="02-mean_difference.html#cb94-3" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m, <span class="dv">60</span>, <span class="dv">10</span>) <span class="co"># 正規分布N(50,100)からm個の乱数を発生</span></span>
<span id="cb94-4"><a href="02-mean_difference.html#cb94-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>) <span class="co"># 正規分布N(60,100)からn個の乱数を発生</span></span>
<span id="cb94-5"><a href="02-mean_difference.html#cb94-5" aria-hidden="true" tabindex="-1"></a>r_yy <span class="ot">&lt;-</span> <span class="fl">0.7</span>  <span class="co"># 信頼性係数</span></span>
<span id="cb94-6"><a href="02-mean_difference.html#cb94-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb94-7"><a href="02-mean_difference.html#cb94-7" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">cohens_d</span>(A, B)<span class="sc">$</span>Cohens_d   <span class="co"># Cohen&#39;s d_s</span></span>
<span id="cb94-8"><a href="02-mean_difference.html#cb94-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-9"><a href="02-mean_difference.html#cb94-9" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> m <span class="sc">+</span> n <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb94-10"><a href="02-mean_difference.html#cb94-10" aria-hidden="true" tabindex="-1"></a>h <span class="ot">=</span> df<span class="sc">/</span>m <span class="sc">+</span> df<span class="sc">/</span>n</span>
<span id="cb94-11"><a href="02-mean_difference.html#cb94-11" aria-hidden="true" tabindex="-1"></a>rpb <span class="ot">=</span> (d <span class="sc">*</span> <span class="fu">sqrt</span>(d<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> h))<span class="sc">/</span>(d<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> h)</span>
<span id="cb94-12"><a href="02-mean_difference.html#cb94-12" aria-hidden="true" tabindex="-1"></a>rpbc <span class="ot">=</span> rpb<span class="sc">/</span><span class="fu">sqrt</span>(r_yy)</span>
<span id="cb94-13"><a href="02-mean_difference.html#cb94-13" aria-hidden="true" tabindex="-1"></a>dc <span class="ot">=</span> (rpbc <span class="sc">*</span> <span class="fu">sqrt</span>(h))<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rpbc<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb94-14"><a href="02-mean_difference.html#cb94-14" aria-hidden="true" tabindex="-1"></a>dc</span></code></pre></div>
<pre><code>## [1] 1.677166</code></pre>
<p>既存のパッケージを利用した場合でも同様の結果が得られる。</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="02-mean_difference.html#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psychmeta)</span>
<span id="cb96-2"><a href="02-mean_difference.html#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="fu">correct_d</span>(<span class="at">correction =</span> <span class="st">&quot;meas&quot;</span>, <span class="at">d =</span> d, <span class="at">ryy =</span> r_yy, <span class="at">n1=</span>m, <span class="at">n2=</span>n)</span></code></pre></div>
<pre><code>## d Values Corrected for Measurement Error:
## ---------------------------------------------------------------------------------------
##   value CI_LL_95 CI_UL_95   n n_effective
## 1  1.68      1.2     2.28 200        96.1</code></pre>
</div>
<div id="範囲制限の補正" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> 範囲制限の補正<a href="02-mean_difference.html#範囲制限の補正" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>範囲制限とは、母集団を代表しないサブ集団から標本を抽出したことによって、測定変数の範囲が母集団よりも小さくなる状況を指す。例えば、年齢と認知機能の相関を検討する際、65歳から69歳の参加者だけを対象とした調査を行えば、2変数間に強い相関が見られる可能性は極めて低い。なぜなら、参加者の年齢が制限されており、年齢の変動が少ないため、認知能力との相関が検出できないからである。</p>
<p>この問題に対して、範囲が制限されていなかった場合の測定変数の標準偏差が分かれば、範囲制限の補正を行うことができる。制限のない母集団の標準偏差を<span class="math inline">\(s_p\)</span>、制限された標準偏差を<span class="math inline">\(s_r\)</span>とすると、補正係数<span class="math inline">\(U\)</span>は以下の式で求められる。</p>
<p><span class="math display">\[
U=\frac{s_p}{s_r}
\]</span> 補正係数<span class="math inline">\(U\)</span>を用いて、標準化平均値差<span class="math inline">\(d_s\)</span>と誤差分散は以下のように補正できる。</p>
<p><span class="math display">\[
df=m+n-2, \\
h=\frac{df}{m}+\frac{df}{n},  \\
r_{pb}=\frac{d_s\sqrt{d_s^2+h}}{d_s^2+h}, \\
r_{pb_c}=\frac{U*r_{pb}}{\sqrt{(U^2-1)r_{pb}^2+1}},\\
d_c=\frac{r_{pb_c}\sqrt{h}}{\sqrt{1-r_{pb_c}^2}}, \\
V_{d_c}=\frac{d_c}{d_s}*V_{d_s}
\]</span></p>
<p>Rを利用すれば、以下のように計算できる。</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="02-mean_difference.html#cb98-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="dv">100</span> ; n <span class="ot">&lt;-</span> <span class="dv">100</span>   <span class="co"># サンプルサイズ</span></span>
<span id="cb98-2"><a href="02-mean_difference.html#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)         <span class="co"># 乱数の種の固定</span></span>
<span id="cb98-3"><a href="02-mean_difference.html#cb98-3" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(m, <span class="dv">60</span>, <span class="dv">10</span>) <span class="co"># 正規分布N(50,100)からm個の乱数を発生</span></span>
<span id="cb98-4"><a href="02-mean_difference.html#cb98-4" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="dv">50</span>, <span class="dv">10</span>) <span class="co"># 正規分布N(60,100)からn個の乱数を発生</span></span>
<span id="cb98-5"><a href="02-mean_difference.html#cb98-5" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fl">1.2</span>  <span class="co"># 標準偏差比</span></span>
<span id="cb98-6"><a href="02-mean_difference.html#cb98-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-7"><a href="02-mean_difference.html#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effectsize)</span>
<span id="cb98-8"><a href="02-mean_difference.html#cb98-8" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">cohens_d</span>(A, B)<span class="sc">$</span>Cohens_d   <span class="co"># Cohen&#39;s d_s</span></span>
<span id="cb98-9"><a href="02-mean_difference.html#cb98-9" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> m <span class="sc">+</span> n <span class="sc">-</span> <span class="dv">2</span></span>
<span id="cb98-10"><a href="02-mean_difference.html#cb98-10" aria-hidden="true" tabindex="-1"></a>h <span class="ot">=</span> df<span class="sc">/</span>m <span class="sc">+</span> df<span class="sc">/</span>n</span>
<span id="cb98-11"><a href="02-mean_difference.html#cb98-11" aria-hidden="true" tabindex="-1"></a>rpb <span class="ot">=</span> (d <span class="sc">*</span> <span class="fu">sqrt</span>(d<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> h))<span class="sc">/</span>(d<span class="sc">^</span><span class="dv">2</span> <span class="sc">+</span> h)</span>
<span id="cb98-12"><a href="02-mean_difference.html#cb98-12" aria-hidden="true" tabindex="-1"></a>rpbc <span class="ot">=</span> U<span class="sc">*</span>rpb<span class="sc">/</span><span class="fu">sqrt</span>((U<span class="sc">^</span><span class="dv">2-1</span>)<span class="sc">*</span>rpb<span class="sc">^</span><span class="dv">2</span><span class="sc">+</span><span class="dv">1</span>)</span>
<span id="cb98-13"><a href="02-mean_difference.html#cb98-13" aria-hidden="true" tabindex="-1"></a>dc <span class="ot">=</span> (rpbc <span class="sc">*</span> <span class="fu">sqrt</span>(h))<span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> rpbc<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb98-14"><a href="02-mean_difference.html#cb98-14" aria-hidden="true" tabindex="-1"></a>dc</span></code></pre></div>
<pre><code>## [1] 1.528827</code></pre>
</div>
</div>
<div id="名称の混乱問題について" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> 名称の混乱問題について<a href="02-mean_difference.html#名称の混乱問題について" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>※研究者によって好き勝手な記号を使いすぎ問題。後で加筆。</p>
<p><img src="images/McGrathMeyer2006.png" alt="研究によって異なる記号が使用される. Figure from McGrath &amp; Meyer (2006)" /></p>

</div>
</div>
<h3> 引用文献リスト<a href="11-discussion.html#引用文献リスト" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="refs" class="references csl-bib-body hanging-indent" line-spacing="2">
<div id="ref-cohen1988" class="csl-entry">
Cohen, J. (1988). <em>Statistical power analysis for the behavioral sciences</em>. L. Erlbaum Associates.
</div>
<div id="ref-delacre2021" class="csl-entry">
Delacre, M., Lakens, D., Ley, C., Liu, L., &amp; Leys, C. (2021). <em>Why hedges’g* s based on the non-pooled standard deviation should be reported with welch’s t-test</em>. <a href="https://doi.org/10.31234/osf.io/tu6mp">https://doi.org/10.31234/osf.io/tu6mp</a>
</div>
<div id="ref-glass1981" class="csl-entry">
Glass, G. V., McGaw, B., &amp; Smith, M. L. (1981). <em>Meta-analysis in social research</em>. SAGE Publications.
</div>
<div id="ref-grissom2001" class="csl-entry">
Grissom, R. J., &amp; Kim, J. J. (2001). Review of assumptions and problems in the appropriate conceptualization of effect size. <em>Psychological Methods</em>, <em>6</em>(2), 135–146. <a href="https://doi.org/10.1037/1082-989x.6.2.135">https://doi.org/10.1037/1082-989x.6.2.135</a>
</div>
<div id="ref-grissom2005" class="csl-entry">
Grissom, R. J., &amp; Kim, J. J. (2005). <em>Effect sizes for research: A broad practical approach</em>. Lawrence Erlbaum Associates. <a href="https://books.google.co.jp/books?id=4C49CGkNxLAC">https://books.google.co.jp/books?id=4C49CGkNxLAC</a>
</div>
<div id="ref-hedges1981" class="csl-entry">
Hedges, L. V. (1981). Distribution theory for glass’s estimator of effect size and related estimators. <em>Journal of Educational Statistics</em>, <em>6</em>(2), 107. <a href="https://doi.org/10.2307/1164588">https://doi.org/10.2307/1164588</a>
</div>
<div id="ref-hedges1985" class="csl-entry">
Hedges, L. V., &amp; Olkin, I. (1985). <em>Statistical methods for meta-analysis</em>. Academic press.
</div>
<div id="ref-hunter2004" class="csl-entry">
Hunter, J. E., Schmidt, F. L., &amp; Sage Publications, inc. (2004). <em>Methods of meta-analysis: Correcting error and bias in research findings</em>. SAGE Publications. <a href="https://books.google.co.jp/books?id=kImkui18i94C">https://books.google.co.jp/books?id=kImkui18i94C</a>
</div>
<div id="ref-kline2004" class="csl-entry">
Kline, R. B. (2004). <em>Beyond significance testing: Reforming data analysis methods in behavioral research.</em> American Psychological Association. <a href="https://doi.org/10.1037/10693-000">https://doi.org/10.1037/10693-000</a>
</div>
<div id="ref-nakagawa2007" class="csl-entry">
Nakagawa, S., &amp; Cuthill, I. C. (2007). Effect size, confidence interval and statistical significance: a practical guide for biologists. <em>Biological Reviews</em>, <em>82</em>(4), 591–605. <a href="https://doi.org/10.1111/j.1469-185x.2007.00027.x">https://doi.org/10.1111/j.1469-185x.2007.00027.x</a>
</div>
<div id="ref-inoue2008" class="csl-entry">
井上俊哉. (2008). ブートストラップ BCa 法による効果量 <span class="math inline">\(\delta\)</span> の信頼区間. <em>東京家政大学研究紀要 1 人文社会科学</em>, <em>48</em>, 1–7. <a href="http://id.nii.ac.jp/1653/00009232/">http://id.nii.ac.jp/1653/00009232/</a>
</div>
<div id="ref-haebara2014" class="csl-entry">
南風原朝和. (2014). <em>続・心理統計学の基礎: 統合的理解を広げ深める</em>. 有斐閣. <a href="https://books.google.co.jp/books?id=h-vFrQEACAAJ">https://books.google.co.jp/books?id=h-vFrQEACAAJ</a>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="01-mean.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="03-correlation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/Daiki-Nakamura-git/effectsize/edit/master/02-mean_difference.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["effectsize.pdf", "effectsize.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
